<?xml version="1.0" standalone="yes" ?>
<scenario>
--Name: chess
--URL: https://github.com/zetaglest/chess
--Description: 2 player chess with Indian faction on a 64x64 map
--Goal: Your fire golem must survive
--By Andy Alt and Jammyjamjamman
--License: GNU GPLv3
<difficulty value="4"/>
<players>
	<player control="human" faction="indian" team="1"/>
	<player control="network" faction="indian" team="2"/>

</players>
<map value="forest_for_four"/>
<tileset value="autumn"/>
<tech-tree value="megapack"/>
	<default-resources value="true"/>
	<default-units value="false"/>
	<default-victory-conditions value="false"/>
	--<fog-of-war value="false"/>

	<scripts>
		<startup>

			-- Create non-king "chess" pieces.
			function createUnits(unitTable, numPlayers)
				for playerNum=0,numPlayers-1
				do
					for unit, count in pairs(unitTable)
					do
						for _=0,count-1
						do
							createUnit(unit, playerNum, startLocation(playerNum))
						end
					end
				end
			end

			-- Create all pieces.
			function createAll(startUnits, kingUnit, numPlayers)
				kings = createKings(kingUnit, numPlayers)
				createUnits(startUnits, numPlayers)
				return kings
			end

			-- List of start pieces (except the king).
			startUnits = {
				thunderbird=1,
				stickfighter=8,
				fire_archer=2,
				spearman=2,
				horseman=2,
			}

			-- Number of players
			nPlayers = 2

			-- Create the kings (fire golems).
            kings = {}
			for playerNum=0,nPlayers-1
			do
				createUnit("fire_golem", playerNum, startLocation(playerNum))
				kings[playerNum] = lastCreatedUnit()
			end

			-- Create other pieces.
			createUnits(startUnits, nPlayers)

			-- Used later to determine the end of the game.
			playersLeft = nPlayers

			-- Tell the player what to do.
			showMessage('game_brief', 'Chess')
		</startup>


		<unitDied>

			unitKilled = lastDeadUnit()

			for player, king in pairs(kings)
			do
				-- Check if the killed unit is the king.
				if unitKilled == king
				then
					-- Delete the killed king.
					kings[player] = nil
					-- Decrement the number of remaining players.
					playersLeft = playersLeft - 1
				end
			end

			-- Set the winner if there's only 1 player alive.
			if playersLeft == 1
			then
				for player, king in pairs(kings)
				do
					clearDisplayText()
					setPlayerAsWinner(player)
					endGame()
				end
			end

		</unitDied>



	</scripts>
</scenario>
